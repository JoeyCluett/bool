<root>

    <module name="2-to-1-mux">

        <gate type="NOT" name="not0"/>
        <gate type="AND" name="and0"/>
        <gate type="AND" name="and1"/>
        <gate type="OR"  name="or0"/>

        <signal from="not0" to="and1.A"/>
        <signal from="and0" to="or0.A"/>
        <signal from="and1" to="or0.B"/>

        <input name="SEL" to="and0.A:not0.A"/>
        <input name="A1" to="and0.B"/>
        <input name="A0" to="and1.B"/>

        <output name="Y" from="or0"/>

    </module>

    <module name="4-to-1-mux">

        <instance type="2-to-1-mux" name="lower-left"/>
        <instance type="2-to-1-mux" name="lower-right"/>
        <instance type="2-to-1-mux" name="upper"/>

        <signal from="lower-left.Y"  to="upper.A1"/>
        <signal from="lower-right.Y" to="upper.A0"/>

        <inputvec size="4" name="IN" 
            to="lower-right.A0:lower-right.A1:lower-left.A0:lower-right.A1"/>
        <inputvec size="2" name="SEL" 
            to="(lower-left.SEL,lower-right.SEL):upper.SEL"/>

        <output name="Y" from="upper.Y"/>

    </module>

    <module name="8-to-1-mux">

        <instance type="4-to-1-mux" name="lower-left"/>
        <instance type="4-to-1-mux" name="lower-right"/>
        <instance type="2-to-1-mux" name="upper"/>

        <signal from="lower-left.Y" to="upper.A1"/>
        <signal from="lower-right.Y" to="upper.A0"/>

        <inputvec size="8" name="IN"
            to="lower-right.IN:lower-left.IN"/>

        <!-- to="" is targeting mulitple sub-inputs of a nested instance -->
        <inputvec size="3" name="SEL"
            to="(lower-left.SEL[0],lower-right.SEL[0]):(lower-left.SEL[1],lower-right.SEL[1]):upper.SEL"/>

    </module>

</root>